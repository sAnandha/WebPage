<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Redirecting to Login...</title>
  <script src="https://cdn.jsdelivr.net/npm/oidc-client-ts@2.1.1/dist/oidc-client-ts.min.js"></script>
</head>
<body>
  <h3>Checking session... Please wait</h3>

  <script>
    const userManager = new window.oidc.UserManager({
      authority: "https://cognito-idp.us-east-1.amazonaws.com/us-east-1_E1V33d9fq",
      client_id: "2g17vttj8eeb7fhacugmmfnkeq",
      redirect_uri: "https://main.de43hd7rcr7qe.amplifyapp.com/dashboard.html",
      response_type: "code",
      scope: "openid email phone"
    });

    userManager.getUser().then(user => {
      if (user && !user.expired) {
        // Already signed in, go to dashboard
        window.location.href = "dashboard.html";
      } else {
        // Not signed in, redirect to Cognito login
        userManager.signinRedirect();
      }
    }).catch(err => {
      console.error("Error checking user session:", err);
      userManager.signinRedirect(); // Fallback to login
    });
  </script>
</body>
</html>
